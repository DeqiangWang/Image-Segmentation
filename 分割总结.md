# Image Segmentation

## Application
1. 无人驾驶
2. 图片编辑
3. 自动驾驶、机器人交互、在线视频处理、甚至手机计算

## Chanllenge
1. 对象/场景的外观变化、遮挡和上下文理解的缺乏
2. 语义分割需要对每个训练图像进行精确的每像素标注，这将花费大量的成本和时间
3. 基于卷积神经网络的语义分割方法依赖于对像素级地面真相的监督，但不能很好地推广到不可见的图像域
4. 网络学习上下文语义信息的能力
5. 小物体分割效果不好
6. 在图像分类任务上预训练导致的特征图空间分辨率的损失，语义分割任务需要恢复细节信息
	- 学习上采样滤波器
	- 使用扩张卷积保持特征大的接受野生成密集预测
7. 越大的crop尺度对语义分割任务性能更好，但这同时需要更大的GPU存储空间，相应的这会减少Batch Normalization的batchsize，弱化训练过程
8. 图片分辨率是影响速度的最主要的因素. 同时，发现网络中kernel的数量也是一个重要的因素,使得不能实时
## 分割体系结构
1. 负责提取粗略语义特征的下采样路径; 
2. 训练上采样路径以将模型输出的分辨率恢复至输入图像分辨率大小; 
3. 处理模块（例如，条件随机场）来优化模型预测。（可选）
## 语义分割方面的模型结构改进思路
1. 改善上采样路径并增加FCN内的连通性; 
2. 引入模块来进行更充分的上下文理解; 
3. 赋予FCN架构提供结构化输出的能力。（可选）
## 解决FCN上采样路径中的分辨率恢复问题的方案
1. 简单的双线性插值；
2. 更复杂的运算符，包括unpooling和转置卷积等； 
3. 下采样路径到上采样路径之间的跳过连接（skip connection）；
4. 恒等映射和长跳过连接的结合

## 为语义分割网络引入更大上下文的方法
1. 为特征图中的每个像素添加一个无监督全局图像描述符（论文：Unrolling loopy 
top-down semantic feedback in convolutional deep networks） 
2. 利用RNN网络在水平和垂直两个方向上扫描图像来检索上下文信息（论文：Reseg: A recurrent 
neural network-based model for semantic segmentation）
3. 引入扩张卷积来替代后期的CNN池化层，以捕获更大的上下文而不降低图像分辨率（论文：Semantic image segmentation with deep convolutional nets and fully connected crfs） 
4. 为FCNs提供一个上下文模块作为（built as）一个扩张卷积层的堆栈来扩大网络的视野（论文：Multi-scale context aggregation by dilated  convolutions）
## 分割的研究方向
1. 实时
2. 高分辨率
3. 高质量

## Solution
1. **扩张卷积存在的问题**
	- 会将像素从全局场景上下文相隔开，这会导致像素错误分类
	- 网格效应
2. **金字塔结构存在的问题**
	- 对上下文表示都不够明确，这出现了一个问题： 捕获上下文信息是否等同于增加接受野大小？
3. **FCN**
	- 没有考虑到局部和全局的上下文依赖，那对语义分割非常有用
4. **多尺度**
	- 多尺度特征的集成。因为在深度网络中，高层特征包含较多的语义信息，较少的位置信息。 
结合多尺度特征能够提升效果。

## Paper
1. **Adversarial learning for semi-supervised semantic segmentation**
	- **解决的问题**

		- 人工标注数据集耗时耗力
		
	- 这些方法通常假定每个像素都有有限的或没有可用的注释，例如在映像级上的附加注释
	- 测试阶段不会增加任何计算代价
	- 这些弱监督的方法仍然落后全监督的方法，尤其是因为从这些弱监控信号中很难推断出详细的边界信息。
    - 通过利用未标记图像的鉴别网络响应来帮助训练分割网络，从而促进半监督学习
	- **贡献**
		* 开发了一个对抗框架，可以在推理过程中提高语义分割的准确性，而无需额外的计算负担
		* 通过利用未标记图像的鉴别网络响应来帮助训练分割网络，从而促进半监督学习.


2. **Learning to Adapt Structured Output Space for Semantic Segmentation**
	- **解决的问题**
		*  缩小源域和目标域之间的差距，目标域中不存在注释
	- 语义分割的特征适应可能会受到高维特征的复杂性的影响，这些特征需要编码不同的视觉线索，包括外观、形状和上下文。
	- 开发一种有效的方法来适应像素级的预测任务，而不是使用特征适应
	- 利用分割是结构化输出的事实，在源域和目标域之间共享许多相似之处。
	- **贡献**
		* 首先，我们提出了一种基于对抗性学习的像素级语义分割领域适应方法。
		* 其次，我们证明了在输出(分割)空间中的适应可以有效地对齐源和目标图像之间的场景布局和局部上下文。
		* 第三，提出了一种多层次的对抗学习方案，以适应不同层次的细分模型特征，提高了性能。

3. **Context Encoding for Semantic Segmentation**
	- **解决的问题**
		* 可以提高小物体的分割精度
		* 缓解类别不平衡
	- CNNs能够通过叠加具有非线性和向下采样的卷积层来获取具有全局感受视野的信息表示。为了克服与向下采样相关的空间分辨率损失问题，最近的研究使用了扩张型的卷积策略来从预先训练的网络中产生密集的预测，但是这种策略也将像素从全局场景中分离出来，导致错误分类的像素
	- 最近的方法通过使用基于多分辨率金字塔的表示来扩大接受域，达到了最先进的性能。例如，PSPNet采用了空间金字塔池，将特征集成不同的大小，并在进行上行采样后将它们连接起来，Deeplab提出了一种空间金字塔池，采用了大速率的扩张/收缩。虽然这些方法确实提高了性能，但是上下文表示并不是显式的，这导致了以下问题:感知上下文信息和增加接收域大小是一样的吗?
	- 提出一种与类别预测相关的网络结构，使得在一定程度上降低了分割任务的难度，同时提高了小物体的分割精度。
	- 充分利用场景上下文和存在类别概率的之间的强相关性，
	- **贡献**
		* 提出了上下文编码模块合并了语义编码loss(SE-Loss)，一个利用全局场景上下文信息的简单单元。上下文编码模块集成了一个编码层来捕获全局上下文，并有选择地突出显示类依赖的特性。我们引入语义编码丢失(SE-loss)来规范训练，使网络能够预测场景中对象类别的存在，从而加强语义上下文的网络学习。与每个像素的损失不同的是，对于大的和小的对象来说，损失都是相等的，我们发现小对象的性能在实践中经常得到改善。所提出的上下文编码模块和语义编码丢失在概念上是直接的，并且与现有的基于FCN的方法相兼容
		* EncNet通过包含一个上下文编码模块，增加了一个预先训练的深度残差网络，使用预先训练过的网络的扩张策略
	- 结果
	![](G://TIM截图20180604144607.png)

4. **ReNet: A Recurrent Neural Network Based Alternative to Convolutional Networks**
	- **解决的问题**
		* 考虑了局部和全局上下文信息
	- 利用循环神经网络RNN从图像中检索上下文信息。
	- ReNet层可以有效地从图像中捕获上下文依赖性，首先水平地扫描图像，然后垂直地扫描隐藏状态的输出。ReNet层的输出隐式地编码了每个像素位置上与整个输入图像相关的局部特征，提供了相关的全局信息。
	- 为了充分利用局部和全局像素依赖，我们将ReNet层叠加在FCN的输出之上
	- RNN和类RNN模型在语义分割文献中越来越流行，以获取长距离像素依赖关系，用于检索全局空间依赖关系

5. **Pyramid Scene Parsing Network**
	- **解决的问题**
		*  全局平均池化很好的被应用到分割任务上，但是对于复杂的ADE20K数据集，使用全局均值池化产生的描述子不足以代表这些上下文信息。直接混合他们形成一个向量会丢失空间相关性和引起二义性
		*  小尺寸的物体难以被识别
	- 通过金字塔池化与金字塔场景解析网络来实现不同区域上下文信息的整合，从而探索全局上下文信息对场景理解能有多大的帮助
	- 为了获得精确的场景感知，自然而然地就需要场景上下文信息来作为先验知识。对应典型的复杂场景理解，事先获得整张图像的全局特征，空间金字塔池化被应用，因为其中可以有不同的空间信息来描述整体场景
	- 为了去除不同子区域之间的上下文信息损失，本文采用层级的全局先验知识，包含不同尺度不同区域的信息
	- **贡献**
		* 提出一种金字塔场景解析网络结构，为了将困难场景的上下文信息嵌入到以FCN为基础的像素预测网络上。
		* 提出一种深度ResNet的优化方法，使用深度loss
6. **ICNet for Real-Time Semantic Segmentation on High-Resolution Images**
	- **解决的问题**
		* realtime semantic segmentation
		* 分割质量不太差
	- 利用低分辨率图片的高效处理和高分辨率图片的高推理质量，来提出了一个图片级联框架实现分割. 
	- **贡献**
		* 提出了一个图片级联网络(ICNet)，它利用低分辨率的语义信息和高分辨率的细节信息. 
		* 提出的ICNet完成了5x+的推理提速，并减少5+的内存消耗. 
		* 实现1024x2048分辨率图片30.3fps分割性能.
	- 结果
	![](G://TIM截图20180604214605.png)

7. **Understanding Convolution for Semantic Segmentation**
	- 解决问题
		* 如果所有网络层都使用相同的 dilation rates r，卷积采样 very sparse，局部信息不完整，信息不相关，信息不一致 
		* 双线性插值不是可学习的而且会丢失信息
	- 改善
		* dense upsampling convolution (DUC) 代替 Bilinear upsampling
		* 用 hybrid dilated convolution (HDC) 代替 传统的 dilated convolution
	- 提出了一个 dense upsampling convolution框架，可以增加感受视野扩大全局信息，并且解决了网格问题，这是由于标准的空洞卷积造成的。
8. **RTSeg: Real-time Semantic Segmentation Comparative Study**
	- **解决问题**
		* 大多数的语义细分研究都是为了提高细分模型的准确性，而忽略了计算效率的解决方案。在这个方向上进行的少数工作没有提供有原则的方法来评估不同的分割设计选择。本文提出了一种基于解耦设计的基于特征提取和解码的实时语义分割基准框架
	- **贡献**
		* 提供了一种模块化的分割体系结构解耦，将其转化为特征提取和解码方法，称为元体系结构，这种分离有助于理解网络不同部分对实时性能的影响。
		* 对精确与计算效率之间的权衡进行了详细的研究
		* 框架的模块化设计使得出现了两种新的分割架构，分别使用MobileNet和ShuffleNet，使用多种解码方法。
	- 提出了对实时分割网络进行基准测试的第一个原则方法。该框架的解耦设计分离了模块，以便进行更好的定量比较。第一个模块由特征提取网络体系结构组成，第二个模块是提供解码方法的元体系结构。在我们的框架中包含了三种不同的元架构，包括Skip架构、UNet和Dilation Frontend。包含了用于特征提取的不同网络架构，分别是ShuffleNet、MobileNet、VGG16和ResNet-18。我们的基准测试框架为研究人员和实践者提供了评估他们的任务的设计选择的方法。